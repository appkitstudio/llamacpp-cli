#!/usr/bin/env node

// CLI entry point - runs the TypeScript CLI directly with tsx in development
// or the compiled JS in production

const path = require('path');
const { spawn } = require('child_process');

const isDevelopment = process.env.NODE_ENV !== 'production';
const projectRoot = path.join(__dirname, '..');

if (isDevelopment) {
  // Development: use tsx to run TypeScript directly
  const tsxPath = path.join(projectRoot, 'node_modules', '.bin', 'tsx');
  const cliPath = path.join(projectRoot, 'src', 'cli.ts');

  const child = spawn(tsxPath, [cliPath, ...process.argv.slice(2)], {
    stdio: 'inherit',
    cwd: projectRoot,
  });

  child.on('exit', (code) => process.exit(code || 0));
} else {
  // Production: run compiled JavaScript
  require(path.join(projectRoot, 'dist', 'cli.js'));
}
